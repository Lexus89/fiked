/*
 * IKE MITM for Cisco PSK+XAUTH.
 * Copyright (C) 2005, Daniel Roethlisberger <daniel@roe.ch>
 * 
 * All rights reserved.  This is unpublished work.  Unauthorized use,
 * distribution in source or binary form, modified or unmodified, is
 * strictly prohibited.
 * 
 * $Id$
 */



// Overview

This is a proof of concept implementation of MITM on PSK+XAUTH [1]
as used by Cisco in their VPN Concentrator 3000 product line.

This implementation is very limited in scope, it only works in very
specific environments.  The only supported type of MITM is IKE in
Aggressive Mode using PreShared Keys (PSK) and XAUTH.  The only
supported algorithm suite is 3DES-CBC, MD5, DH group 2.  It is not
supposed to be a comprehensive MITM implementation.  The only aim
is to demonstrate that using PSK+XAUTH is a bad idea security-wise.

Actually, xauth-mitm is a misnomer, as it does not implement a full
MITM attack, it just impersonates a VPN gateway to grab XAUTH user
credentials.



// Attack Setup

To successfully use xauth-mitm, you must be able to intercept the
IKE traffic between the clients and the VPN gateway.  Ways to
achieve this include posing as a legit 802.11 access point using
hostap, transparently tapping into Ethernet cables at a suitable
location, and ARP spoofing.  Whichever method you choose, you will
need to redirect the IKE traffic to your local instance of
xauth-mitm using your favourite firewall (eg. pf, iptables).

If you don't know how to set all this up, you probably should not
be running xauth-mitm in the first place.  I will not answer any
support requests of this kind.



// Requirements

 * libgcrypt from http://directory.fsf.org/security/libgcrypt.html



// Further Reading

[1] http://www.cisco.com/warp/public/707/cisco-sn-20040415-grppass.shtml
[2] http://ipsec-wit.antd.nist.gov/newipsecdoc/pluto.html
[3] http://www.faqs.org/rfcs/rfc2407.html
[4] http://www.faqs.org/rfcs/rfc2408.html
[5] http://www.faqs.org/rfcs/rfc2409.html


