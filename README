/*
 * IKE MITM for Cisco PSK+XAUTH.
 * Copyright (C) 2005, Daniel Roethlisberger <daniel@roe.ch>
 * 
 * All rights reserved.  This is unpublished work.  Unauthorized use,
 * distribution in source or binary form, modified or unmodified, is
 * strictly prohibited.
 * 
 * $Id$
 */



// Overview

This is a proof of concept implementation of MITM on PSK+XAUTH [1].

This implementation is very limited in scope, it only works in very
specific environments.  The only supported type of MITM is IKE in
aggressive mode using PreShared Keys (PSK) and XAUTH.  The only
supported algorithm suite is 3DES-CBC, MD5, DH group 2.  It does
not support main mode, but that could be easily implemented too.

Actually, MITM is not quite correct, because this implementation
just stops responding to the client as soon as the XAUTH user
credentials are received.  Full MITM could be implemented, but I
haven't done it.



// Attack Setup

To successfully demostrate an attack on a VPN site, you must be
able to intercept the IKE traffic between the clients and the VPN
gateway.  Ways to achieve this include posing as a legit 802.11
access point using hostap, transparently tapping into Ethernet
cables at a suitable location, or ARP spoofing.  Whichever method
you choose, you will need to redirect the IKE traffic to your box
using your favourite firewall (eg. pf, iptables).

If you don't know how to set all this up, you probably should not
be running xauth-mitm in the first place.  I will not answer any
support requests of this kind.



// Requirements

 * libgcrypt from http://directory.fsf.org/security/libgcrypt.html



// Further Reading

[1] http://www.cisco.com/warp/public/707/cisco-sn-20040415-grppass.shtml



